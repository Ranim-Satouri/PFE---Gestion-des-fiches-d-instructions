<div class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-[100]">
  <!-- Conteneur principal avec position relative -->
  <div class="bg-white p-6 rounded-lg shadow-lg w-fit relative max-h-[90vh] overflow-y-auto">
    <!-- Bouton X avec z-index élevé et position fixe -->
    <button (click)="closeForm()"
            type="button"
            class="absolute top-[5px] right-1 text-gray-400 bg-transparent hover:bg-blue-100 hover:text-gray-500 rounded-lg
            text-sm w-8 h-8  inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
            data-modal-hide="default-modal">
      <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
      </svg>
      <span class="sr-only">Close modal</span>
    </button> <br>
    <!-- Contenu du formulaire -->
    <!-- Stepper -->
    <div data-hs-stepper="" >

      <ol class="flex items-center w-full p-3 space-x-2 text-sm font-medium text-center
      text-gray-500 bg-white border border-gray-200 rounded-lg shadow-xs dark:text-gray-400
       sm:text-base dark:bg-gray-800 dark:border-gray-700 sm:p-4 sm:space-x-4 rtl:space-x-reverse" >
        <li *ngFor="let step of steps; let i = index"
            class="flex items-center gap-x-1"
            [ngClass]="{ 'text-blue-600 dark:text-blue-500': currentStep === i + 1,
            'text-gray-500 dark:text-gray-400': currentStep !== i + 1 }">
          <!-- Numéro d'étape avec couleur dynamique -->
          <span class="flex items-center justify-center w-6 h-6
           text-x border rounded-full shrink-0"
                [ngClass]="{ 'border-blue-600 bg-blue-600 text-white dark:border-blue-500 dark:bg-blue-500': currentStep === i + 1,
                       'border-gray-500 dark:border-gray-400': currentStep !== i + 1 }">
      {{ i + 1 }}</span>
          <!-- Texte de l'étape -->
          <span class="hidden sm:inline-flex ms-0.5">{{ step }}</span>
          <!-- Icône de séparation -->
          <svg *ngIf="i < steps.length - 1"
               class="w-3 h-3 ms-2 sm:ms-4 rtl:rotate-180" aria-hidden="true"
               xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 10">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 9 4-4-4-4M1 9l4-4-4-4"/>
          </svg></li></ol>
      <!-- End Stepper Nav -->
      <!-- Stepper Content -->
      <div class="mt-5 sm:mt-8">
          <div class="flex flex-row justify-around p-2
           border-gray-200 rounded-xl dark:bg-neutral-800 dark:border-neutral-700 ">
  <form [formGroup]="registerForm"  (ngSubmit)="submitForm()" class="w-fit max-w-md mx-auto z-40">
    <!-- First Content -->

    <div  *ngIf="currentStep === 1" data-hs-stepper-content-item='{  "index": 1 }'>
              <!-- Nom et Prénom sur la même ligne -->
              <div class="flex flex-row space-x-3 bg-white rounded-lg w-full ">
                <!-- Nom -->
                <div class="relative bg-inherit w-fit">

                  <input type="text" id="Nom" name="Nom" class="peer bg-transparent h-10 rounded-lg
          text-gray-800 placeholder-transparent ring-2 px-2 ring-gray-300 focus:ring-sky-600 w-full
          focus:outline-none focus:border-rose-600" placeholder="nom"
                         formControlName="nom"
                         [ngClass]="{
            'border-red-500 ring-red-500': registerForm.get('nom')?.invalid && registerForm.get('nom')?.touched,
            'border-gray-400 dark:border-gray-700': !(registerForm.get('nom')?.invalid && registerForm.get('nom')?.touched)
          }"/>

                  <label for="Nom" class="absolute cursor-text left-2 -top-3 text-sm text-gray-500 bg-white
          px-1 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2
          peer-focus:-top-3 peer-focus:text-sky-600 peer-focus:text-sm transition-all">Nom</label>
                </div>

              <!-- Prénom -->
              <div class="relative bg-inherit w-1/2 ">

                <input type="text" id="Prénom" name="Prénom" class=" peer bg-transparent h-10 rounded-lg  w-full
        text-gray-800 placeholder-transparent ring-2 px-2 ring-gray-300 focus:ring-sky-600
        focus:outline-none focus:border-rose-600" placeholder="Prenom" formControlName="prenom" [ngClass]="{
            'border-red-500 ring-red-500': registerForm.get('prenom')?.invalid && registerForm.get('prenom')?.touched,
            'border-gray-400 dark:border-gray-700': !(registerForm.get('nom')?.invalid && registerForm.get('prenom')?.touched)
          }"/>

                <label for="Prénom" class="absolute cursor-text left-2 -top-3 text-sm text-gray-500 bg-white
        px-1 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2
        peer-focus:-top-3 peer-focus:text-sky-600 peer-focus:text-sm transition-all">Prénom</label>
              </div>
            </div>

            <!-- Matricule en dessous -->
            <div class="relative bg-white  mt-4 rounded-lg ">

              <input type="text" id="matricule" name="email" class="peer bg-transparent h-10 w-full  rounded-lg
        text-gray-800 placeholder-transparent ring-2 px-2 ring-gray-300 focus:ring-sky-600
        focus:outline-none focus:border-rose-600" placeholder="email" formControlName="email" [ngClass]="{
            'border-red-500 ring-red-500': registerForm.get('matricule')?.invalid && registerForm.get('matricule')?.touched,
            'border-gray-400 dark:border-gray-700': !(registerForm.get('matricule')?.invalid && registerForm.get('matricule')?.touched) }" />

                <label for="matricule" class="absolute cursor-text left-2 -top-3 text-sm text-gray-500 bg-white w-fit pl-0.5
        px-4 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2
        peer-focus:-top-3 peer-focus:text-sky-600 peer-focus:text-sm transition-all">
                  Matricule</label></div><br>
<!--num et genre-->

          <div class="flex flex-row space-x-3 bg-white rounded-lg w-full">
            <!-- Num -->
<!--            <div class="relative bg-inherit ">-->

            <div class="relative bg-inherit w-full">
          <select id="Genre" name="Genre" formControlName="genre" class="peer  block h-10 rounded-lg ring-2
           text-gray-500 focus:border-blue-400  px-2  dark:bg-gray-700 ring-gray-300 focus:ring-sky-600 w-full
         dark:focus:border-blue-300  focus:outline-none focus:ring focus:ring-opacity-40 ">
            <option value="" selected disabled>Genre</option>
            <option value="FEMME">Femme</option>
            <option value="HOMME">Homme</option>
          </select></div>
          </div></div>
        <!-- End First Content -->
        <!-- Second Content -->
              <div *ngIf="currentStep === 2" class=" border-gray-200 rounded-xl
dark:bg-neutral-800 dark:border-neutral-700 w-full min-w-[400px] h-auto">
          <div class="relative bg-white  mt-3.5 rounded-lg w-full ">
            <input type="text" id="email" name="email" class="peer bg-transparent h-10 w-full  rounded-lg
        text-gray-800 placeholder-transparent ring-2 px-2 ring-gray-300 focus:ring-sky-600
        focus:outline-none focus:border-rose-600 mb-1.5" placeholder="email" formControlName="matricule" [ngClass]="{
            'border-red-500 ring-red-500': registerForm.get('email')?.invalid && registerForm.get('email')?.touched,
            'border-gray-400 dark:border-gray-700': !(registerForm.get('email')?.invalid && registerForm.get('email')?.touched) }" />

              <label for="email" class="absolute cursor-text left-2 -top-3 text-sm text-gray-500 bg-white w-fit pl-0.5
        px-4 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2
        peer-focus:-top-3 peer-focus:text-sky-600 peer-focus:text-sm transition-all">
              Email</label></div>
          <div class="relative bg-white  mt-4 rounded-lg 5.5">

            <input type="text" id="numero" name="numero" class="peer bg-transparent h-10 w-full  rounded-lg
        text-gray-800 placeholder-transparent ring-2 px-2 ring-gray-300 focus:ring-sky-600
        focus:outline-none focus:border-rose-600" placeholder="Password" formControlName="numero" [ngClass]="{
            'border-red-500 ring-red-500': registerForm.get('numero')?.invalid && registerForm.get('numero')?.touched,
            'border-gray-400 dark:border-gray-700': !(registerForm.get('numero')?.invalid && registerForm.get('numero')?.touched) }"/>

              <label for="numero" class="absolute cursor-text left-2 -top-3 text-sm text-gray-500 bg-white w-fit pl-0.5
        px-4 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2
        peer-focus:-top-3 peer-focus:text-sky-600 peer-focus:text-sm transition-all">
              Numéro</label><br></div><br></div>
        <!-- End Second Content -->
        <!-- 3 Content -->
    <div *ngIf="currentStep === 3" class="border-gray-200 rounded-xl dark:bg-neutral-800 dark:border-neutral-700 w-full min-w-[400px] h-auto">
      <!-- Role and Status Row -->
      <div class="flex flex-row space-x-3 bg-white rounded-lg w-full">
        <div class="relative w-full z-50">
          <input
            class="py-2.5 sm:py-3 ps-4 pe-9 block w-full border border-gray-300 rounded-lg sm:text-sm focus:border-blue-400 dark:focus:border-blue-300 focus:ring-blue-300 focus:outline-none focus:ring focus:ring-opacity-40 dark:bg-gray-700 dark:text-gray-400"
            type="text" formControlName="role" [value]="searchText" (input)="onSearchChange()" (focus)="showDropdown = true" placeholder="Role" name="searchText" />
          <div class="absolute top-1/2 end-3 -translate-y-1/2 cursor-pointer" (click)="toggleDropdown()">
            <svg class="shrink-0 size-3.5 text-gray-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m7 15 5 5 5-5"></path>
              <path d="m7 9 5-5 5 5"></path>
            </svg>
          </div>
          <div *ngIf="showDropdown" id="dropDown" class="absolute z-[90] bg-white shadow-md w-full dark:bg-gray-700 border border-gray-50 rounded-lg left-0 top-full mt-1 max-h-40 overflow-y-auto">
            <div *ngFor="let r of filteredRoles" (click)="selectRole(r)" class="cursor-pointer py-2 px-4 text-sm text-gray-800 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-600">
              {{ r }}
            </div>
          </div>
        </div>
        <div class="relative bg-inherit w-full">
          <select id="status" formControlName="status" class="peer block h-10 rounded-lg ring-2 text-gray-500 focus:border-blue-400 px-2 dark:bg-gray-700 ring-gray-300 focus:ring-sky-600 w-full dark:focus:border-blue-300 focus:outline-none focus:ring focus:ring-opacity-40">
            <option value="" selected disabled>Status</option>
            <option value="ACTIVE">ACTIVE</option>
            <option value="INACTIVE">INACTIVE</option>
          </select>
        </div>
      </div><br>

      <!-- Zone Section -->
      <div class="relative flex sm:gap-6 ml-3">
        <details class="group w-full"> <!-- Changed w-fit to w-full -->
          <summary class="flex items-center justify-between border-b border-gray-300 pb-1 text-gray-700
          transition-colors hover:border-gray-400 hover:text-gray-900 w-full ">
            <span class="text-sm font-medium">Zone</span>
            <span class="transition-transform group-open:-rotate-180">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.6" stroke="currentColor" class="size-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
          </svg>
        </span>
          </summary>
          <!-- Dropdown -->
          <div class="absolute bg-white overflow-y-auto
          shadow-md w-[65%] dark:bg-gray-700 border border-gray-50 rounded-lg left-0 top-full mt-1 max-h-20
           divide-y divide-gray-300">
            <div class="flex items-center justify-between px-3 py-2">
              <span class="text-sm text-gray-700">{{ registerForm.get('zones')?.value }} Selected</span>
            </div>
            <fieldset class="p-3">
              <legend class="sr-only" id="zone">Checkboxes</legend>
              <div class="flex flex-col items-start gap-3"> <!-- Removed absolute from here -->
                <label *ngFor="let zone of zones" class="inline-flex items-center gap-3">
                  <input type="checkbox" class="size-5 rounded border-gray-300 shadow-sm" [value]="zone.idZone" (change)="toggleZoneSelection(zone.idZone || 1)" />
                  <span class="text-sm font-medium text-gray-700">{{ zone.nom }}</span>
                </label>
              </div>
            </fieldset>
          </div>
        </details>
      </div>
    </div>
        <!-- End First Content -->
        <!-- Button Group -->
        <div class="mt-5 flex justify-between items-center gap-x-2">
          <button (click)="goToPreviousStep()" type="button" class="py-2 px-3 inline-flex items-center gap-x-1 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700" data-hs-stepper-back-btn="">
            <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m15 18-6-6 6-6"></path>
            </svg>
           Retour
          </button>
          <button (click)="goToNextStep()" type="button" class="py-2 px-3 inline-flex items-center gap-x-1 text-sm font-medium rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 focus:outline-hidden focus:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none" data-hs-stepper-next-btn="">
            {{ currentStep === 3 ? 'Enregistrer' : 'Suivant' }}
            <svg class="shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6"></path>
            </svg>
          </button>
        </div></form></div><!-- End Button Group -->
      </div><!-- End Stepper Content --></div>
    <!-- End Stepper --></div> </div>
